# Quick Reference - Firebase Grocery App

## ğŸš€ Quick Start

```bash
# Clone and setup
git clone <repo>
cd w3-Grocery-App-flutter-mockup-main

# Install dependencies
flutter pub get

# Run on device/emulator
flutter run

# Build APK
flutter build apk --release
```

## ğŸ”‘ Key Code Snippets

### Initialize Firebase (main.dart)
```dart
void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  await Firebase.initializeApp(
    options: DefaultFirebaseOptions.currentPlatform,
  );
  runApp(const GroceryApp());
}
```

### Sign In
```dart
await FirebaseAuth.instance.signInWithEmailAndPassword(
  email: email,
  password: password,
);
```

### Sign Up with Firestore
```dart
final userCredential = await FirebaseAuth.instance.createUserWithEmailAndPassword(
  email: email,
  password: password,
);
await FirebaseFirestore.instance.collection('users').doc(userCredential.user!.uid).set({
  'fullName': fullName,
  'email': userCredential.user!.email,
  'createdAt': FieldValue.serverTimestamp(),
});
```

### Read User Data (Real-time)
```dart
StreamBuilder<DocumentSnapshot>(
  stream: FirebaseFirestore.instance
      .collection('users')
      .doc(FirebaseAuth.instance.currentUser?.uid)
      .snapshots(),
  builder: (context, snapshot) {
    if (snapshot.hasData) {
      final userData = snapshot.data?.data() as Map<String, dynamic>;
      return Text(userData['fullName'] ?? 'User');
    }
    return Text('Loading...');
  },
)
```

### Update User Data
```dart
await FirebaseFirestore.instance
    .collection('users')
    .doc(FirebaseAuth.instance.currentUser!.uid)
    .update({'fullName': newName});
```

### Logout
```dart
await FirebaseAuth.instance.signOut();
```

## ğŸ“± Navigation

### Auth Gate
```dart
home: StreamBuilder<User?>(
  stream: FirebaseAuth.instance.authStateChanges(),
  builder: (context, snapshot) {
    if (snapshot.hasData) {
      return RootShell(...); // Logged in
    }
    return LoginScreen(); // Logged out
  },
)
```

## ğŸ—„ï¸ Firestore Schema

```
firestore/
â””â”€â”€ users (collection)
    â””â”€â”€ {uid} (doc - auto-generated by Auth UID)
        â”œâ”€â”€ fullName (string)
        â”œâ”€â”€ email (string)
        â””â”€â”€ createdAt (timestamp)
```

## âš™ï¸ Firebase Rules (Recommended)

```json
{
  "rules": {
    "users": {
      "{uid}": {
        ".read": "request.auth.uid == uid",
        ".write": "request.auth.uid == uid"
      }
    }
  }
}
```

## ğŸ“‚ File Map

```
lib/
â”œâ”€â”€ main.dart                    â† Firebase init + Auth routing
â”œâ”€â”€ firebase_options.dart         â† Platform configs
â”œâ”€â”€ login_screen.dart            â† Sign In/Sign Up
â””â”€â”€ pages/
    â”œâ”€â”€ homepage.dart            â† Real-time greeting
    â”œâ”€â”€ profile.dart             â† User profile + logout
    â””â”€â”€ ... (other pages)
```

## ğŸ” Common Tasks

### Check if user is logged in
```dart
final user = FirebaseAuth.instance.currentUser;
if (user != null) {
  // User is logged in
}
```

### Get current user UID
```dart
final uid = FirebaseAuth.instance.currentUser?.uid;
```

### Get current user email
```dart
final email = FirebaseAuth.instance.currentUser?.email;
```

### Handle auth errors
```dart
try {
  await FirebaseAuth.instance.signInWithEmailAndPassword(
    email: email,
    password: password,
  );
} on FirebaseAuthException catch (e) {
  print(e.message); // "User not found.", "Wrong password.", etc.
}
```

## ğŸ§ª Testing

### Test Sign Up Flow
1. Open app â†’ See LoginScreen
2. Click "CREATE AN ACCOUNT"
3. Fill form and submit
4. Check Firestore for new user doc

### Test Real-time Sync
1. Open app on two devices
2. Edit profile on one device
3. Check if other device updates instantly

### Test Offline
1. Disable internet
2. Try to login â†’ Should show error
3. Enable internet â†’ Try again

## ğŸ› Debugging

### Check Firestore Data
1. Go to Firebase Console
2. Navigate to Firestore Database
3. Check 'users' collection
4. Find document with user UID

### Check Auth Logs
```dart
FirebaseAuth.instance.authStateChanges().listen((user) {
  print('Auth state: ${user?.email}');
});
```

### Check Firestore Listeners
```dart
FirebaseFirestore.instance.collection('users').snapshots().listen((event) {
  print('Firestore updated: ${event.docs.length} docs');
});
```

## âš ï¸ Common Errors & Solutions

| Error | Solution |
|-------|----------|
| `user-not-found` | Email doesn't exist, try Sign Up |
| `wrong-password` | Incorrect password |
| `email-already-in-use` | Email already registered |
| `invalid-email` | Check email format |
| `weak-password` | Password should be 6+ characters |
| `permission-denied` (Firestore) | Check Firestore Rules |
| `FirebaseException: unknown` | Check internet connection |

## ğŸ“ Links

- [Firebase Console](https://console.firebase.google.com/)
- [Flutter Firebase Docs](https://firebase.flutter.dev/)
- [Firestore Docs](https://firebase.google.com/docs/firestore)

---

**Last Updated**: December 8, 2025  
**Version**: 1.0.0
